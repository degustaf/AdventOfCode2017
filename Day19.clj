(defn traverse [data]
  (let [path (vec (map (comp vec seq) (clojure.string/split-lines data)))
        sym-map {\| \- \- \|}
        dir-map {\| '((0 1) (0 -1)) \- '((1 0) (-1 0))}]
    (loop [sym \|
           x (list 0 (.indexOf (first path) \|))
           v '(1 0)
           ret ""
           cnt 0]
      (let [y (get-in path x)]
        (cond
          (= y \space) (list ret cnt)
          (nil? y) (list ret cnt)
          (contains? #{\| \-} y) (recur sym (map + x v) v ret (inc cnt))
          (= y \+) (let [v-new (first (remove #(let [z (get-in path (map + % x))]
                                                 (or (nil? z) (= z \space)))
                                              (dir-map sym)))]
                     (recur
                       (sym-map sym)
                       (map + x v-new)
                       v-new
                       ret
                       (inc cnt)))
          :else (recur sym (map + x v) v (str ret y) (inc cnt)))))))

(= (traverse "     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ 
") '("ABCDEF" 38))

(def data "                           |                                                                                                                                                                             
       +-------------------|---+   +-------------------------------------------------------------------------+     +---------+       +-----+       +-----------------------------------------+ +---+     
       |                   |   |   |                                                                         |     |         |       |     |       |                                         | |   |     
   +-+ |                   |   |   |           +-------------+     +-----------------+       +---------------------------------------|-------------------------------------------------------|-----|-+   
   | | |                   |   |   |           |             |     |                 |       |               |     |         |       |     |       |                                         | |   | |   
   | | |                   |   |   |         +-+             |     +-------------------------|---------------|-----------------------|-----|-------|-----------------------+         +-------------+ |   
   | | |                   |   |   |         |               |                       |       |               |     |         |       |     |       |                       |         |       | |     |   
   | +-|-------+           |   |   +---------------------------------+   +-----------|-----------+   +-------------|---------|-------|-----|-------+                       |     +-------------|---+ |   
   |   |       |           |   |             |               |       |   |           |       |   |   |       |     |         |       |     |                               |     |   |       | |   | |   
   |   |   +---------------|---|-------------|---------------------------------------------------|-+ |     +-------|---------+       |     |                               |     |   |       | |   | |   
   |   |   |   |           |   |             |               |       |   |           |       |   | | |     | |     |                 |     |                               |     |   |       | |   | |   
   |   |   |   |           |   |             |               |       |   |           | +---------+ | |     +-------|-----------------|-----------------+                   |     +-------+ +---+   | |   
   |   |   |   |           |   |             |               |       |   |           | |     |     | |       |     |                 |     |           |                   |         |   | | |     | |   
   |   |   |   |       +---|-----------------|-----------------------|---------------|-------|-+ +-|---------|-----------------------------|-------------------------------+ +-------+   | | |     | |   
   |   |   |   |       |   |   |             |               |       |   |           | |     B | | | |       |     |                 |     |           |                     |           | | |     | |   
   +---|-----+ +---------------|-------------|---------------|-----+ |   |           | |     | | | | |       |     |                 |     |           |                     |           | | |     | |   
       |   | |         |   |   |             |               |     | |   |           | |     | | | | |       |     |                 |     |           |                     |           | | |     | |   
 +-----------+         |   |   |             |               |     | |   |           | |     | | | | +-------|-----------------------+     |           |                     |           | +-|---------+ 
 |     |   |           |   |   |             |               |     | |   |           | |     | | | |         |     |                       |           |                     |           |   |     | | | 
 |     |   | +---------|---|-----------------|---------------|-------|---------------|-------|-----|---------------------------------+     |       +---|-----------+         |           |   |     | | | 
 |     |   | |         |   |   |             |               |     | |   H           | |     | | | |         |     |                 |     |       |   |           |         |           |   |     | | | 
 |     |   | |         |   |   | +-----------------------------------|---------------------------|-|---------------------------------------------------------------|-----------------+   |   |     | | | 
 |     |   | |         |   |   | |           |               |     | |   |           | |     | | | |         |     |                 |     |       |   |           |         |       |   |   |     | | | 
 | +-+ |   | |     +-----------|-+           |               |     | |   |           | |     | | | |         |     |                 |     |       |   |           |         |       |   |   |     | | | 
 | | | |   | |     |   |   |   |             |               |     | |   |           | |     | | | |         |     |                 |     |       |   |           |         |       |   |   |     | | | 
 | | | |   | |     |   |   |   | +-+         |               |     | |   |           | |     | | | |         |     |                 |     |       |   |         +-+ +---------------|---|-----+ +-----+ 
 | | | |   | |     |   |   |   | | |         |               |     | |   |           | |     | | | |         |     |                 |     |       |   |         |   |       |       |   |   | | | | |   
 | | | |   | |     +-+ |   |   | | |         | +-------------|----------Z|-------------------|-|-|-----------|-----|-------------+   |     |       |   |         |   |       |       |   |   | | | | |   
 | | | |   | |       | |   |   | | |         | |             |     | |   |           | |     | | | |         |     |             |   |     |       |   |         |   |       |       |   |   | | | | |   
 | | | |   | |       | |   |   | | |         | |             |     | |   |           | |     | | | |         |     |             |   |     |       |   |         |   |       |       |   |   | | | | |   
 | | | |   | |       | |   |   | | |         | |             |     | |   |           | |     | | | |         |     |             |   |     |       |   |         |   |       |       |   |   | | | | |   
 | | | |   | |   +---|-----|---|-|-|-------+ | |             |     | |   |           | |     | | | +---------|-------------------|---|-------+     |   |         |   |       |       |   |   | | | | |   
 | | | |   | |   |   | |   |   | | |       | | |             |     | |   |           | |     | | |           |     |             |   |     | |     |   |         |   |       |       |   |   | | | | |   
 | | | |   | |   |   | | +-|---|---+       | | |           +-------|-|---------------|-------|---|-----------|-----------------------|-----|-|-----|-------------------------------------|---|---|-----+ 
 | | | |   | |   |   | | | |   | |         | | |           | |     | |   |           | |     | | |           |     |             |   |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | +-|---|-|-------|-|-----------|---------+   | | +-----|-+ |           | |     | | |           |     |             |   |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | |   | | | |   | |         | | |       |   | | |   | | | |           | |     | | |           |     |             |   |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | |   | | | |   | | +-------|-+ |       |   | | |   | +---|-------------|-----|-|-------------|-------------------|-+ |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | |   | | | |   | | |       |   |       |   | | |   |   | |           | |     | | |           |     |             | | |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | |   | | | |   | +-+       |   |       |   | | |   +---|-|-----------|-------|-|-|-----------------|---------+   | | |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | |   | | | |   |           |   |       |   | | |       | |           | |     | | |           |     |         |   | | |     | |     |   |         |   |       |       |   |   | | | | | | 
 | | | |   | | | +-----|-|-----|---------------|-------|-+ | | |     +-|-|-----------|-------|-+ |         +-|---------------------|-|-----|-------|-------------|-+ |       |       |   |   | | | | | | 
 | | | |   | | |     | | | |   |           |   |       | | | | |     | | |           | |     |   |         | |     |         |   | | |     | |     |   |         | | |       |       |   |   | | | | | | 
 | | | |   | | |     | | | |   |           |   |       | | | | |     | | |           | |     |   | +---------|-+ +-------+   |   | | |     | |     | +-|---------+ | |       |       |   |   | | | | | | 
 | | | |   | | |     | | | |   |           |   |       | | | | |     | | |           | |     |   | |       | | | | |     |   |   | | |     | |     | | |           | |       |       |   |   | | | | | | 
 | | | |   | | |     | | | |   |   +-----+ |   |   +-----|-|---------|-|---------------------|-------+     | | | | |     |   |   | | |     | |     | | |           | |       |       |   |   | | | +---+ 
 | | | |   | | |     | | | |   |   |     | |   |   |   | | | | |     | | |           | |     |   | | |     | | | | |     |   |   | | |     | |     | | |           | |       |       |   |   | | |   |   
 | | | |   | | |     | +-|-|---|---|-----|-------------------|-|-----|---------------|-|-------+ | | |     | | | | |     |   |   | | |     | |     | | |           | | +-------------|-+ |   | | |   |   
 | | | |   | | |     |   | |   |   |     | |   |   |   | | | | |     | | |           | |     | | | | |     | | | | |     |   |   | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | | +---|---|-+   +---|-|---|---|-------+   |   |   | +-|-|-------------+   +-----|-|---------|---+     | | | | |     |   |   | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     | | | |       | |   |   |     |     |   |   |   | | |     | | | |   |     | |     | | | |       | | | | |     |   |   | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     | | | |     +-|---------|---------------|-------|---------|-|-|-|---|-----|---------|-----------|---|-|-|-----|---+   | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     | | | |     | | |   |   |     |     |   |   |   | | |     | | | |   |     | |     | | | |       | | | | |     |       | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     | +-|---------|-|---|---------|---------------------|-----------|---|-----|-|-----|---|-----------------|-----|---------|-|-----|-+     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     | | |   |   |     |     |   |   |   | | |     | | | |   |     | |     | | | |       | | | | |     |       | | |     |       | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     | +---+ |   |     |     |   |   | +-----|-----|-|-|-|-----------------|-|-|---------|-|-|-|-|-----|-------|-|-|-----|-+     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     |   | | |   |     |     |   |   | | | | |     | | | |   |     | |     | | | |       | | | | |     |       | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     |   | | |   |     |     |   |   | +---------------+ |   |     | |     | | | |       | | | | |     |       | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     |   | | |   |     |     |   |   |   | | |     | |   |   |     | |     | | | |       | | | | |     |       | | |     | |     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     |   | | | +-+     |     |   |   |   | +---------|---|---------|-------|-|-|-|-------|-|---|-|-----------------|-------+     | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     |   | | | |       |     |   |   |   |   |     | |   |   |     | |     | | | |       | | | | |     |       | | |     |       | | |           | | |     |       | | |   | | |   |   
 | | |     |   | |     | +---|-|---------|-----|-----------|---|---------------|-----|-----------|-|-------|-----|-----------------|-|-----|---------------------------+     |       +-------|-|-+   |   
 | | |     |   | |     | | | | | |       |     |   |   |   |   |     | |   |   |     | |     | | | |       | | | | |     |       | | |     |       | | |           | |       |         | |   | |     |   
 | | |     |   | |     | +---|-|-|-+ +---------|---|-----------|-----|-|-------------|-------|-|---|---------|-|-|-|-------------|---------+       | | |   +-------|-|-----------------|-|-+ | |     |   
 | | |     |   | |     |   | | | | | |   |     |   |   |   |   |     | |   |   |     | |     | | | |       | | | | |     |       | | |             | | |   |       | |       |         | | | | |     |   
 | | |     |   | +-+   | +-----|-+ | |   |     +---|-------|---+     | |   |   | +---|-|-------+ | |       | | | | |     |       | | |     +-------|-|-----|---------------------------------|-|-+   |   
 | | |     |   |   |   | | | | |   | |   |         |   |   |         | |   |   | |   | |     |   | |       | | | | |     |       | | |     |       | | |   |       | |       |         | | | | | |   |   
 | | |     |   |   |   | +-|-|---------------+     |   |   |         | |   |   | |   | |     |   | |     +---|---|-------|-------|-|---------------|---------------|---------|---------|-----------+ |   
 | | |     |   |   |   |   | | |   | |   |   |     |   |   |         | |   |   | |   | |     |   | |     | | | | | |     |       | | |     |       | | |   |       | |       |         | | | | | | | |   
 | | |     +-------------+ | | | +---------------------|---------+   | |   |   | |   | |     |   | | +-----|-----|-------|-------|-|-|-----|---------|-|-------------+       |         | | | | | +---|-+ 
 | | |         |   |   | | | | | | | |   |   |     |   |   |     |   | |   |   | |   | |     |   | | |   | | | | | |     |       | | |     |       | | |   |       |         |         | | | | |   | | | 
 | | | +-------|---------|---|-------|---------------------------|---|-|---------|-+ | |     |   | | |   | | | | | |     |   +---|-|-|-------------|---|---------------------|---+     | | | | |   | | | 
 | | | |       |   |   | | | | | | | |   |   |     |   |   |     |   | |   |   | | | | |     |   | | |   | | | | | |     |   |   | | |     |       | | |   |       |         |   |     | | | | |   | | | 
 | | | |   +---------------------|---|-------|---------+   |   +-|-+ +-----|-------|---|-----------|---------|-----|---+ |   |   | | |     |       | | |   |       |         |   |     | | | | +-+ | | | 
 | | | |   |   |   |   | | | | | | | |   |   |     |       |   | | |   |   |   | | | | |     |   | | |   | | | | | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
 +-|-------+   |   |   | | | | | | | |   |   |   +-|-------+   | | |   |   |   | | | | |     |   | | |   | | | | | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | |           | | |   |   |   | | | | |     |   | | |   | | | | | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | +---------|-|-|-------|---|-------|-----|-----|-|-----|-|-+ | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | |         | | |   |   |   | | | | |     |   | | |   | | |   | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | |         | | |   |   |   | | | | |     |   | | +-----|-+   | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | |         | | |   |   |   | | | | |     |   | |     | |     | |   | |   |   | | |     |       | | |   |       |         |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | |         | | |   | +-|---|-----|-|---------+ |     | |     | |   | +---|-------------|---+   | | |   |       |     +-+ |   |     | | | |   | | | | 
   | | |       |   |   | | | | | | | |   |   |   | | |         | | |   | | |   | | | | |     |     |     | |     | |   |     |   | | |     |   |   | | |   |       |     | | |   |     | | | |   | | | | 
   | | |       +---|---|-----|-------|-------------|-----------+ | | +-----+   | | | | |     |     |     | |     +-|---|-----|---|-|---------------|-|-------------|-------------------+ | | | +-----|-+ 
   | | |           |   | | | | | | | |   |   |   | | |           | | | | |     | | | | |     |     |     | |       |   |     |   | | |     |   |   | | |   |       |     | | |   |       | | | | | | |   
   | | |           |   | | +-|---|---------------|---------------|---|-------------|-|-|-----|-----|-----|-|-----------|---------|-+ |     |   +-----|-----|-------|-------|-----------------|-|---|-|-+ 
   | | |           |   | |   | | | | |   |   |   | | |           | | | | |     | | | | |     |     |     | |       |   |     |   |   |     |       | | |   |       |     | | |   |       | | | | | | | | 
 +-|-|-------------|---------|---|-------|---|-+ | | |           | | | | |     | | | | |     |     |     | | +-----|-----------------|-----|---------|-|---|-+     |     | | |   |       | | | | | | | | 
 | | | |           |   | |   | | | | |   |   | | | | |           | | | | |     | | | | |     |     |     | | |     |   |     |   |   |     |       | | |   | |     |     | | |   |       | | | | | | | | 
 | | | |           |   | |   | | | | | +-----|---|-----------------|-------------|-|---|-----|-----|-------|-|---------------|---|---------+       | | |   | |     |     | | |   |       | | | | | | | | 
 | | | |           |   | |   | | | | | | |   | | | | |           | | | | |     | | | | |     |     |     | | |     |   |     |   |   |             | | |   | |     |     | | |   |       | | | | | | | | 
 | | | +-----------------|-------|---|-+ |   | | | +-|---------+ | | | | |     | | | | |     |     +-----|-|-------|---|-----|-----------------------|-|---|-|-----|-------|-|---|-------------|-|-+ | | 
 | | |             |   | |   | | | | |   |   | | |   |         | | | | | |     | | | | |     |           | | |     |   |     |   |   |             | | |   | |     |     | | |   |       | | | | |   | | 
 +-|-------------+ |   | | +-+ +-|---|---------|-|---|-----------|---|---+     | | | | |     |           | | |     |   |     | +-|-----------------|---|---|---------------|-|-----------|-|-|-|---+ | | 
   | |           | |   | | |     | | |   |   | | |   |         | | | | |       | | | | |     |           | | |     |   |     | | |   |             | | |   | |     |     | | |   |       | | | | | | | | 
   | |     +-----|-----|-|-|-----|-|-|--W--------------------------------------|-------------|-----------|-|-----------------+ | |   |             | | |   | |     |     | | |   |       | | | | | | | | 
   | |     |     | |   | | |     | | |   |   | | |   |         | | | | |       | | | | |     |           | | |     |   |       | |   |             | | |   | |     P     | | |   |       | | | | | | | | 
   | |     | +---|-|---|---------|-|-----------|-----|---------+ | | | |   +-----|-|-----------------+   | | +-----|-----+     | |   |             | | |   | +-------------|-+   |       | | | | | | | | 
   | |     | |   | |   | | |     | | |   |   | | |   |           | | | |   |   | | | | |     |       |   | |       |   | |     | |   |             | | |   |       |     | |     |       | | | | | | | | 
   | |     | |   | |   | | |     | +-|-------|-----+ |           | | | |   |   | | | | |     |       |   | |       |   | |     | |   |             | | |   |       |     | |     |       | | | | | | | | 
   | |     | |   | |   | | |     |   |   |   | | | | |           | | | |   |   | | | | |     |       |   | |       |   | |     | |   |             | | |   |       |     | |     |       | | | | | | | | 
 +-+ +-+   | |   | |   | | |     |   |   |   | | | | |       +-+ +-------------|-|-|-|---------------------|-------------|-------|---|-----------+ | | |   |       |     | |     |       | | | | | | | | 
 |     |   | |   | |   | | |     |   |   |   | | | | |       | |   | | |   |   | | | | |     |       |   | |       |   | |     | |   |           | | | |   |       |     | |     |       | | | | | | | | 
 |     |   | | +---|-----|-|-------------------|-|-|-|-------|-------|-----|---|---|---------------------|-|---------+ | +-+   | |   |           | | | |   |   +-----+   | |     | +-----+ | | | | | | | 
 |     |   | | | | |   | | |     |   |   |   | | | | |       | |   | | |   |   | | | | |     |       |   | |       | | |   |   | |   |           | | | |   |   |   | |   | |     | |       | | | | | | | 
 |     |   | | | | |   | | |     |   |   |   | | | | |       | |   | | |   |   | | +---+     |       |   | |       | | |   |   | |   |           | | | |   |   |   | |   | |     | |       | | | | | | | 
 |     |   | | | | |   | | |     |   |   |   | | | | |       | |   | | |   |   | |   |       |       |   | |       | | |   |   | |   |           | | | |   |   |   | |   | |     | |       | | | | | | | 
 | +---|---------|-----|-|-|---------|---|---|---|---|-------|-|---|-|---------|-----|-----------------------------|---+   +---|-----|---------------|-|-------|-----------------|---------|-|-+ | | | | 
 | |   |   | | | | |   | | |     |   |   |   | | | | |       | |   | | |   |   | |   |       |       |   | |       | |         | |   |           | | | |   |   |   | |   | |     | |       | |   | | | | 
 | |   |   | | | | |   | | |     |   |   |   | | +---|---------------------|---|-|---|-------------+ |   | |     +-|-----------------------------------|---|---|-----|---------+ | |       | |   | | | | 
 | |   |   | | | | |   | | |     |   |   |   | |   | |       | |   | | |   |   | |   |       |     | |   | |     | | |         | |   D           | | | |   |   |   | |   | |   | | |       | |   | | | | 
 | +-------|---|---|-----|-----------|-------|-|---+ |       | |   | | |   |   +-+   |       |     | |   | |     | | |         | |   |           | | | |   |   |   | +---|-|-----|-+       | |   | | | | 
 |     |   | | | | |   | | |     |   |   |   | |     |       | |   | | |   |         |       |     | |   | |     | | |         | |   |           | | | |   |   |   |     | |   | |         | |   | | | | 
 |     |   | | | | |   | | +-----|-------|---|-|-----|-------|-|-+ +---+   +-----------------|-------|-----|-----|-+ |         | |   |           | | | |   |   |   |   +-+ | +-|-|-----------------|---+ 
 |     |   | | | | |   | |       |   |   |   | |     |       | | |   |               |       |     | |   | |     |   |         | |   |           | | | |   |   |   |   |   | | | |         | |   | | |   
 | +-------|-|-|-|-----|---------|-------|-----|---------------|-|-------------------|-------|-----|-|---------------|---------------|-------------------------|-------|---|-|-|-|---------------|-+ |   
 | |   |   | | | | |   | |       |   |   |   | |     |       | | |   |               |       |     | |   | |     |   |         | |   |           | | | |   |   |   |   |   | | | |         | |   |   |   
 | |   +-----|-|-----+ | |   +---|---|---|-----|-------------|-|-----------------------------|-----------|-|-----|---|---------------------------|-----|-------|---|-------+ | | |         | |   +---+   
 | |       | | | | | | | |   |   |   |   |   | |     |       | | |   |               |       |     | |   | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |       +-+ | | | | | |   |   |   |   |   | |     |       | | +---|---------------|-------------+ |   | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |       | |     |               |       |       |   | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   +---|------C----------------|---------------+   | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |   +-|---------|-----------+               |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |           | | | | | |   |   |   |   |     |     |   |   | |                     |       |           | |     |   |         | |   |           | | | |   |   |   |   |     | | |         | |           
 | |       +---|-----|---|---|-----------|---+ |     |   |   | |                     |       |           | |     |   +---------|-|---------------|-|-----------|---+   |     | | |         | |           
 | |       |   | | | | | |   |   |   |   |   | |     |   |   | |                     |       |           | |     |             | |   |           | | | |   |   |       |     | | |         | |           
 | |       |   | +-|-|---|---|---|---|---|---|-------|---|-----|-----+               |       |           | |     |             | |   +-----------------------------------------|-----------|-|-----+ +-+ 
 | |       |   |   | | | |   |   |   |   |   | |     |   |   | |     |               |       |           | |     |             | |               | | | |   |   |       |     | | |         | |     | | | 
 | |       |   |   | | | |   |   |   |   |   | |     |   |   | |     +-------------------------------------|-------------------|---------+       | | | | +-----|-----------------+         | |     | | | 
 | |       |   |   | | | |   |   |   |   |   | |     |   |   | |                     |       |           | |     |             | |       |       | | | | | |   |       |     | |           | |     | | | 
 | |       |   |   | | | |   | +-|---|-------|-|---------|---------+         +-----+ |       |           | |     |             | |       |       | | | | | |   |       |     | |           | |     +-+ | 
 | |       |   |   | | | |   | | |   |   |   | |     |   |   | |   |         |     | |       |           | |     |             | |       |       | | | | | |   |       |     | |           | |         | 
 | |       |   | +---|-|-----|-----------|---|---+   |   |   | |   |         |     | |       |           | |     |             | |       |       | | +-----------------|-------------------|-|---------+ 
 | |       |   | | | | | |   | | |   |   |   | | |   |   |   | |   |         |     | |       |           | |     |             | |       |       | |   | | |   |       |     | |           | |           
 | |       |   | | | | | |   | | |   +---|---|---|---+ +-------+   |         |     | |       |           | |     |             | |       |       | |   | | |   |       |     | |           | +-----+     
 | |       |   | | | | | |   | | |       |   | | |     | |   |     |         |     | |       |           | |     |             | |       |       | |   | | |   |       |     | |           |       |     
 | |       |   | | | | | |   | | |       |   | | |     | |   |     |         |     | |       |           | |     |             | |       |       | |   | | |   |       |     | |           |       |     
 | |       |   | | | | | |   | | |       |   | | |     | |   |     |         |     | |       |           | |     |             | |       |       | |   | | |   |       |     | |           |       |     
 | |       |   | | | | | |   | | |       |   | | |     | |   |     |         |     | |       |           | |     +---------------|---------------|-|-------------------|-----+ |           |       |     
 | |       |   | | | | | |   | | |       |   | | |     | |   |     |         |     | |       |           | |                   | |       |       | |   | | |   |       |       |           |       |     
 | |       |   | | | | | |   | | |       |   +-+ +-----|-----|-------------------------------------+     | |     +---------------|---------------|-----|-----+ |       |       |           |       |     
 | |       |   | | | | | |   | | |       |             | |   |     |         |     | |       |     |     | |     |             | |       |       | |   | | | | |       |       |           |       |     
 | |       |   | | | | | |   | | |       |             | |   |     |         |     | |       |     |     | |     |             | |       |       | |   | | | | |       |       |           |       | +-+ 
 | |       |   | | | | | |   | | |       |             | |   |     |         |     | |       |     |     | |     |             | |       |       | |   | | | | |       |       |           |       | | | 
 +-|-------|---|-------|-|-------|-------|-------------|-|---|-----|---------|-------|-------|-----|-------------|-------------|-|-----------------|-----|-|-----------|---+   |     +-------------+ | | 
   |       |   | | | | | |   | | |       |             | |   |     |         |     | |       |     |     | |     |             | |       |       | |   | | | | |       |   |   |     |     |         | | 
   |       |   | | | | | |   | | |       |             | | +-|---------------------|-|-------------|-------|-----|-------------+ |       |       | |   | | | | |       |   |   |     |     |         | | 
   |       |   | | | | | |   | | |       |             | | | |     |         |     | |       |     |     | |     |               |       |       | |   | | | | |       |   |   |     |     |         | | 
   |   +-------|---|-|---|---|---|-------|-------+     | | | |     |         |     | |       |     |     | |     |               |       |       | |   +-|-----|-----------|---|-----+     |         | | 
   |   |   |   | | | | | |   | | |       |       |     | | | |     |         |     | |       |     |     | |     |               |       |       | |     | | | |       K   |   |           |         | | 
   |   |   |   +---+ +-|-|---|---|---------------|-----|-|---|---------------|---------------------|-----|-------|-----------------------|-+     | |     | | | |       |   |   | +-----------------+ | | 
   |   |   |     |     | |   | | |       |       |     | | | |     |         |     | |       |     |     | |     |               |       | |     | |     | | | |       |   |   | |         |       | | | 
   |   |   |   +-----------------|-------------+ |     | | | | +-------------|-----|-|-------|-----|---+ | |     |               |       | |     | |     | | | +-------|-------|-----------+       | | | 
   |   |   |   | |     | |   | | |       |     | |     | | | | |   |         |     | |       |     |   | | |     |               |       | |     | |     | | |         |   |   | |                 | | | 
   |   |   |   | |   +---|-------|-------|-------------|-|-|-------|-----------------|-------|-----|-------|-----------------------------|---------+     | | |         |   |   | |                 | | | 
   |   |   |   | |   | | |   | | |       |     | |     | | | | |   |         |     | |       |     |   | | |     |               |       | |     |       | | |         |   |   | |                 | | | 
   |   |   |   | |   | | |   | | |       |     | |     | +-----------------+ |     | |       |     |   | | |     |               |       +---------------|-------------+   |   | |                 | | | 
   |   |   |   | |   | | |   | | |       |     | |     |   | | |   |       | |     | |       |     |   | | |     |               |         |     |       | | |             |   | |                 | | | 
   |   |   |   | |   | | |   | | |       |     | |     |   | | |   |       | |     | |     +-|---------|-|-|-----|----G----------|-------+ |     |       | +-------+       +-----------------------+ | | 
   |   |   |   | |   | | |   | | |       |     | |     |   | | |   |       | |     | |     | |     |   | | |     |               |       | |     |       |   |     |           | |                   | | 
   |   |   |   | +-----|-------|---------|-------------|---|-|-------------|-------|-|-------|-----|-----|-+     +---------------|-----------------------|---|-----|-----------|-|-----------------+ | | 
   |   |   |   |     | | |   | | |       |     | |     |   | | |   |       | |     | |     | |     |   | |                       |       | |     |       |   |     |           | |                 | | | 
   |   |   |   |     | | |   | | |     +-|-------+ +---+ +-|-|-|-----------|-|-----+ +-----|-|---------|-------------------------|-------|-------|-----+ |   |     |           | |                 | | | 
   |   |   |   |     | | |   | | |     | |     |   |     | | | |   |       | |             | |     |   | |                       |       | |     |     | |   |     |           | |                 | | | 
   |   |   |   |     | | |   +-|-------------------------|-----|---|---------|---------------------|---|-+                       |       +-|---------+ | |   |     |           | |                 | | | 
   |   |   |   |     | | |     | |     | |     |   |     | | | |   |       | |             | |     |   |                         |         |     |   | | |   |     |           | |                 | | | 
   |   |   |   |     | | |     | |     | +---------|-------|-|-|---+       | |             | |     |   |                         |         |     |   | | |   |     |           | |                 | | | 
   |   |   |   |     | | |     | |     |       |   |     | | | |           | |             | |     |   |                         |         |     |   | | |   |     |           | |                 | | | 
   | +-|---|---+     +-|-|-----|-|-----|-------|-+ |   +-|-------------------|-------------+ |     |   |                         +---------|-----|---|-------------|-----------+ |                 | | | 
   | | |   |           | |     | |     |       | | |   | | | | |           | |               |     |   |                                   |     |   | | |   |     |             |                 | | | 
   | | |   +---------+ | |     | |     +-----------|-----|---|-------------------------------|---------|---+                               |     |   | | |   |     |             |                 | | | 
   | | |             | | |     | |             | | |   | | | | |           | |               |     |   |   |                               |     |   | | |   |     |             |                 | | | 
   | | |             | | |     | |             | +-|---|-|-----|-------------|-----------------+   |   +-------------------------------------+   |   | | +---|-----|-------------|-----+           | | | 
   | | |             | | |     | |             |   |   | | | | |           | |               | |   |       |                               | |   |   | |     |     |             |     |           | | | 
   | | |             | | |   +-+ +---------------------|-------|-----------|-----------------|-|---|-------+                               | |   |   | |     |     |             |     |           | | | 
   | | |             | | |   |                 |   |   | | | | |           | |               | |   |                                       | |   |   | |     |     |             |     |           | | | 
   | | |             | | +-------------------------|---|-|-|-|-------------|---------------------------------------------------------------------|---|-+     |     | +-----------|-----+           | | | 
   | | |             | |     |                 |   |   | | | | |           | |               | |   |                                       | |   |   |       |     | |           |                 | | | 
   | | |             +-----+ | +-----------------------|---|-|-|-----------|-----------------|-|---|---------------------------------------------+   |       +-------+           |                 | | | 
   | | |               |   | | |               |   |   | | | | |           | |               | |   |                                       | |       |             |             |                 | | | 
   | | |               |   | +-|---+         +---------|-|-|---------------------------------|-|---|---------------------------------------|-------------------------------------|-----------------|---+ 
   | | |               |   |   |   |         | |   |   | | | | |           | |               | |   |                                       | |       |             |             |                 | |   
   | | |               +-------|---|---------|-----|-----|-+ | +-+ +---------|-----------------|---|---------------------------------------------------------------|---+         |         +-----+ | |   
   | | |                   |   |   |         | |   |   | |   |   | |       | |               | |   |                                       | |       |             |   |         |         |     | | |   
 +---|-------------------------|-------------|-----|-----|---|-----|---------------------------+   |                                       | |       |             |   +-------------------+     +-|-|-+ 
 | | | |                   |   |   |         | |   |   | |   |   | |       | |               |     |                                       | |       |             |             |                 | | | 
 | | | |                   |   |   +---------|-|---|-----------------------|-|---------------|-----|-------------------------------------------------+ +-----------|-------------+           +-----|---+ 
 | | | |                   |   |             | |   |   | |   |   | |       | |               |     |                                       | |         |           |                         |     | |   
 | | | |                   |   |             | |   | +-+ |   | +-|-|-------------------------------|---------------------------------------------------|-------------------------------------+     | |   
 | | | |                   |   |             | |   | |   |   | | | |       | |               |     |                                       | |         |           |                               | |   
 | | | |               +---------------------+ |   | |   |   | +-+ +-------|-+               +-----------------------------------------------|---------------------------------+                   | |   
 | | | |               |   |   |               |   | |   |   |             |                       |                                       | |         |           |           |                   | |   
 | +-+ | +-------------+   +---+               +---+ +---+   +-------------+                       +---------------------------------------------------+           |           +-------------------|-+   
 |     | |                                                                                                                                 | |                     |                               |     
 +-----+ +---------------------------------------------------------------------------------------------------------------------------------+ +---------T           +-------------------------------+     
                                                                                                                                                                                                         ")

(traverse data)
